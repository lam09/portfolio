window.__require=function e(t,o,n){function s(i,r){if(!o[i]){if(!t[i]){var a=i.split("/");if(a=a[a.length-1],!t[a]){var c="function"==typeof __require&&__require;if(!r&&c)return c(a,!0);if(l)return l(a,!0);throw new Error("Cannot find module '"+i+"'")}}var d=o[i]={exports:{}};t[i][0].call(d.exports,function(e){return s(t[i][1][e]||e)},d,d.exports,e,t,o,n)}return o[i].exports}for(var l="function"==typeof __require&&__require,i=0;i<n.length;i++)s(n[i]);return s}({AnimationManager:[function(e,t,o){"use strict";cc._RF.push(t,"6cb176EfF5JMLtaMWt/u/xM","AnimationManager"),cc.Class({extends:cc.Component,properties:{},start:function(){console.log("hello, animation manager")}}),cc._RF.pop()},{}],AssetManager:[function(e,t,o){"use strict";cc._RF.push(t,"9fbd1swWmlHL7Po4TeM1NQO","AssetManager");var n=e("Config"),s=cc.Class({extends:cc.Component,properties:{symbolPool:{default:null,type:cc.NodePool}},statics:{instance:null,_assetsList:null,symbolPool:null,sceneList:null},_funcCompleteCb:function(e,t){if(cc.log("prefab loaded"),e)cc.log("Error url ["+e+"]");else{s._assetsList["preflab/Symbol"].res=t,s.instance.symbolPool=new cc.NodePool("Symbol");for(var o=0;o<=n.instance.s_count_x*n.instance.s_count_y;o++){var l=cc.instantiate(t);s.instance.symbolPool.put(l)}}},onLoad:function(){s.instance=this,s._assetsList={"preflab/Symbol":{type:"Prefab",res:null},"CrystalSlots/anim/1explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/2explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/3explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/4explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/5explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/6explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/7explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/8explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/9explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/10explosion":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/1idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/2idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/3idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/4idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/5idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/6idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/7idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/8idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/9idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/10idle":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/1light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/2light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/3light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/4light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/5light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/6light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/7light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/8light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/9light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0},"CrystalSlots/anim/10light":{type:"SpriteAtlas",res:null,totalCount:0,completedCount:0}},this._checkSum=s._assetsList.length,cc.log("asset _check sum = "+this._checkSum);var e=this._funcCompleteCb.bind(this);for(var t in cc.loader.loadRes("preflab/Symbol",e),s._assetsList)this._load(t);cc.director.preloadScene(n.instance.next_level_name,function(){cc.log(n.instance.next_level_name+" scene preloaded")})},_load:function(e){var t=this;if(cc.log("start load asset "+e),null==s._assetsList[e].res){var o=s._assetsList[e].type,n=function(o,n,l){cc.log("cb load inprogressing "+e),s._assetsList[e].totalCount=n,s._assetsList[e].completedCount=o,t.setLoadingProgressState()},l=function(o,n){o||(t._checkSum--,null!=n&&(s._assetsList[e].res=n))};switch(cc.log(o),o){case"SpriteAtlas":cc.loader.loadRes(e,cc.SpriteAtlas,n,l);break;case"SpriteFrame":cc.loader.loadRes(e,cc.SpriteFrame,n,l);break;case"Spine":cc.loader.loadRes(e,sp.SkeletonData,n,l);break;case"Font":cc.loader.loadRes(e,cc.Font,n,l);break;case"Plist":cc.loader.loadRes(e,cc.ParticleAsset,n,l);break;case"Animation":case"Prefab":case"Scene":case"Texture":case"Txt":case"Audio":cc.loader.loadRes(e,n,l);break;case"CORS":cc.loader.load(e,n,l),this.loadTips.textKey="CORS image should report texImage2D error under WebGL and works ok under Canvas";break;default:cc.loader.load(e,n,l)}}},_loadCallBack:function(e,t){this._isLoading=!1,e?cc.log("Error url ["+e+"]"):(this._curRes=t,"Audio"===this._curType?this._btnLabel.textKey=i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.2"):this._btnLabel.textKey=i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.3"),this._btnLabel.textKey+=this._curType,this.loadTips.textKey=this._curType+" Loaded Successfully!")},_getProgress:function(){var e=0,t=0;for(var o in s._assetsList)e+=s._assetsList[o].totalCount,t+=s._assetsList[o].completedCount,s._assetsList[o].completedCount!=s._assetsList[o].totalCount&&(e+=1);return e<100?0:(cc.log("loaded "+t+" of "+e),t/e)},setLoadingProgressState:function(){for(var e in this.total=0,this.completedCount=0,s._assetsList)this.total+=s._assetsList[e].totalCount,this.completedCount+=s._assetsList[e].completedCount;cc.log("loaded "+this.completedCount+" of "+this.total)},_getAsset:function(e){return cc.log("getting asset "+e),null==s._assetsList[e].res&&this._load(e),s._assetsList[e].res},update:function(){}});cc._RF.pop()},{Config:"Config"}],Color:[function(e,t,o){"use strict";cc._RF.push(t,"1e520rfKqVDcoaPgyFlwLIm","Color");t.exports=["#15910F","#EFF808FD","#297AE2FD","#D10E2DFD","#C41DDBFD","#EE18A1FD","#79290FFD","#0A7C65FD","#D112A3FD"],cc._RF.pop()},{}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"0c615TMTI1FUIg5ckFwKl4r","Config");var n=cc.Class({extends:cc.Component,properties:{tetris_speed:{default:1e3,type:cc.Integer},exp_anim_speed:{default:20,type:cc.Integer},idle_anim_speed:{default:30,type:cc.Integer},s_count_x:{default:6,type:cc.Integer},s_count_y:{default:8,type:cc.Integer},current_level:{default:1,type:cc.Integer},heart_count_down:{default:15,type:cc.Integer},level_up_point:{default:15,type:cc.Integer},max_symbol_id:{default:10,type:cc.Integer},min_symbol_id:{default:1,type:cc.Integer},next_level_name:""},statics:{instance:null},onLoad:function(){n.instance=this},_random:function(e,t){return Math.floor(Math.random()*(t-e+1))%(t-e+1)+e},getRandomSymbol:function(){return this._random(this.min_symbol_id,this.max_symbol_id)}});cc._RF.pop()},{}],GameLogic:[function(e,t,o){"use strict";cc._RF.push(t,"493457JsCdFC7mpFpi5FnMF","GameLogic");var n=e("Config"),s=e("Color"),l=e("NextLevelRequierment"),i=e("AssetManager");cc.Class({extends:cc.Component,properties:{pedro:{default:null,type:sp.Skeleton},progressBar:{default:null,type:cc.ProgressBar},pointLabel:{default:null,type:cc.Label},levelLabel:{default:null,type:cc.Label},heartCountDown:{default:null,type:cc.Label},fire:{default:null,type:cc.ParticleSystem},countdownLabel:{default:null,type:cc.Label},current_point:0,current_heart:0,game_state:0,time_countdown:100},startNewGame:function(){this.game_state=1,this.time_countdown=100,this.schedule(this.countDown,1,this.time_countdown,0)},countDown:function(){this.time_countdown--,this.countdownLabel.string=""+this.time_countdown},_addPoint:function(e,t){cc.log("adding point "+e+" "+t),this.current_point+=e,cc.log("height"+this.progressBar.node.width);var o=new cc.v2(this.progressBar.node.width*(this.current_point/this.next_level_required_point),this.progressBar.node.height/2);this.progressBar.progress=this.current_point/this.next_level_required_point*100,cc.log(this.progressBar.progress);var n=cc.moveTo(.5,o);this.fire.node.runAction(n);for(var s=0,i=0;i<l.requierments.length;i++)t==l.requierments[i].symbolId&&(cc.log("Hello world"),l.requierments[i].count-=e,l.requierments[i].count<=0&&(l.requierments[i].count=0),this.requierments[i].getComponent(cc.Label).string=l.requierments[i].count),s+=l.requierments[i].count;0==s?this.gratulation():this.play()},play:function(){this.current_heart--,this.heartCountDown.string=this.current_heart,0==this.current_heart&&this.game_over()},gratulation:function(){this.show_next_level_board()},show_next_level_board:function(){this.game_state=2,this.nextLevelBoard.active=!0,this.nextLevelBoard.getComponent(cc.Animation).play("nextLevelAppearingAnimation"),cc.log("go next level")},close_board:function(){this.nextLevelBoard.active=!1},go_next_level:function(){cc.director.loadScene(n.instance.next_level_name)},game_over:function(){this.game_state=4,this.gameOverBoard.active=!0,this.gameOverBoard.getComponent(cc.Animation).play("nextLevelAppearingAnimation"),cc.log("game over"),this.unschedule(this.countDown)},watchAds:function(){},onLoad:function(){this.manager=cc.find("Canvas/symbolHolder").getComponent("SymbolManager");var e=cc.find("Canvas/GameLogic").getComponent("GameLogic");this.reqs=[],e.init()},playAgain:function(){this.manager._resetSymbols(),4==this.game_state?this.gameOverBoard.active=!1:2==this.game_state&&(this.nextLevelBoard.active=!1),cc.log("play again"),this.init(),this.startNewGame()},init:function(){l.init();var e=0,t=cc.find("Canvas/GameLogic/requirement"),o=!0,r=!1,a=void 0;try{for(var c,d=this.reqs[Symbol.iterator]();!(o=(c=d.next()).done);o=!0)(m=c.value).parent.removeChild(m)}catch(e){r=!0,a=e}finally{try{!o&&d.return&&d.return()}finally{if(r)throw a}}this.reqs=[],this.requierments=[];for(var u=0;u<l.requierments.length;u++){e+=l.requierments[u].count;var m=cc.instantiate(t);this.reqs.push(m);var p=i.instance.symbolPool.get();p.getComponent("Symbol").initializeSymbol(l.requierments[u].symbolId),p.position=new cc.v2(-70,-100),m.addChild(p),m.position=new cc.v2(200*u-463,463);var h=m.getChildByName("count");cc.log(s);var g=cc.Color.BLACK;g.fromHEX(s[l.requierments[u].symbolId-1]),h.color=g,h.getComponent(cc.Label).string=l.requierments[u].count,this.node.addChild(m),this.requierments.push(h)}n.instance.heart_count_down=Math.floor(e/3),this.current_heart=n.instance.heart_count_down,this.heartCountDown.string=this.current_heart,cc.log(l)},start:function(){var e=cc.find("Canvas/level/level");cc.log(e),this.levelLabel.string=n.instance.current_level,this.heartCountDown.string=n.instance.heart_count_down,this.current_heart=n.instance.heart_count_down,this.next_level_required_point=n.instance.level_up_point,this.nextLevelBoard=cc.find("Canvas/NextLevelBoard"),this.nextLevelBoard.active=!1,this.gameOverBoard=cc.find("Canvas/GameOver"),this.gameOverBoard.active=!1,this.startNewGame(),cc.log("Requierment")}}),cc._RF.pop()},{AssetManager:"AssetManager",Color:"Color",Config:"Config",NextLevelRequierment:"NextLevelRequierment"}],LoadAssetManager:[function(e,t,o){"use strict";cc._RF.push(t,"2d8526oWB5DU7LU/+JzF3DN","LoadAssetManager");var n=e("AssetManager"),s=e("Config");cc.Class({extends:cc.Component,properties:{progressBar:{default:null,type:cc.ProgressBar},play_btn:{default:null,type:cc.Button}},onLoad:function(){this.play_btn.node.on("click",this._completeCallback,this)},start:function(){},_progressCallback:function(e,t,o){this.progress=e/t,this.resource=o,this.completedCount=e,this.totalCount=t},_completeCallback:function(e,t){cc.director.loadScene(s.instance.next_level_name)},update:function(e){var t=n.instance._getProgress();if(t>=1)return this.progressBar.node.active=!1,this.enabled=!1,void(this.play_btn.node.active=!0);t<this.progress&&(t+=e),this.progressBar.progress=t}}),cc._RF.pop()},{AssetManager:"AssetManager",Config:"Config"}],NextLevelRequierment:[function(e,t,o){"use strict";cc._RF.push(t,"cfc68KL1fZBvpsxEhUjggJE","NextLevelRequierment");var n=e("Config"),s={requierments:[],init:function(){this.requierments=[];for(var e=0;e<5;e++){for(var t={},o=n.instance.current_level;;){t.symbolId=n.instance.getRandomSymbol();for(var s=!1,l=0;l<e;l++)t.symbolId==this.requierments[l].symbolId&&(s=!0);if(0==s)break}t.count=n.instance._random(3*o,5*o),this.requierments.push(t)}}};t.exports=s,cc._RF.pop()},{Config:"Config"}],Reel:[function(e,t,o){"use strict";cc._RF.push(t,"6aec6bPPytOtKoETZzibgHV","Reel");var n=e("SymbolHolder");cc.Class({extends:cc.Component,properties:{holders:{default:Array(),type:[n]}},movingSymbolsDownByTetris:function(){cc.log("symbol list length "+this.symbolList.length);for(var e=0;e<this.symbolList.length;e++)this.symbolList[e].getComponent("Symbol")._moveSymbolToHolder(this.holders[e])},_playingTetris:function(){this.symbolList=[];for(var e=0,t=0;t<this.holders.length;t++)this.holders[t]._inTetris?e++:this.symbolList.push(this.holders[t].current_symbol);for(var o=1;o<=e;o++){var n=new cc.v2(this.holders[0].node.position.x,this.holders[0].node.position.y+100*o),s=this.manager._createRandomSymbol(this.holders[0].node,n);this.symbolList.unshift(s),this.node.addChild(s),this.holders[0]._assignSymbol(s)}this.movingSymbolsDownByTetris()},updateSymbolList:function(){this.symbolList=[];for(var e=0;e<this.holders.length;e++)this.symbolList.push(this.holders[e].current_symbol)},start:function(){this.manager=cc.find("Canvas/symbolHolder").getComponent("SymbolManager")}}),cc._RF.pop()},{SymbolHolder:"SymbolHolder"}],SymbolHolder:[function(e,t,o){"use strict";cc._RF.push(t,"8cf6caeaa9MPaP+mDcr2gFG","SymbolHolder"),cc.Class({extends:cc.Component,properties:{s_up:{default:null,type:cc.Node},s_down:{default:null,type:cc.Node},s_left:{default:null,type:cc.Node},s_right:{default:null,type:cc.Node},current_symbol:{default:null,type:cc.Node},symbol_manager:{default:null,type:cc.Node},id:{default:0,type:cc.Integer},up_distance:{default:100,type:cc.Integer},down_distance:{default:100,type:cc.Integer},_inTetris:!1,_onExplosion:!1,_onSymbolMoving:!1,_isReady:!0},_assignSymbol:function(e){this.current_symbol=e,this.id=e.getComponent("Symbol").id,e.getComponent("Symbol")._setHolder(this.node)},_getCurrentSymbol:function(){return this.current_symbol},_isPossibleTetris:function(){var e=[],t=this;for(e.push(t);null!=t.getComponent("SymbolHolder").s_up&&t.getComponent("SymbolHolder").s_up.getComponent("SymbolHolder").id==t.getComponent("SymbolHolder").id;)e.push(t.getComponent("SymbolHolder").s_up),t=t.getComponent("SymbolHolder").s_up;for(t=this;null!=t.getComponent("SymbolHolder").s_down&&t.getComponent("SymbolHolder").s_down.getComponent("SymbolHolder").id==t.getComponent("SymbolHolder").id;)e.push(t.getComponent("SymbolHolder").s_down),t=t.getComponent("SymbolHolder").s_down;if(e.length>=2)return!0;for(;e.length>0;)e.pop();for(t=this,e.push(t);null!=t.getComponent("SymbolHolder").s_left&&t.getComponent("SymbolHolder").s_left.getComponent("SymbolHolder").id==t.getComponent("SymbolHolder").id;)e.push(t.getComponent("SymbolHolder").s_left),t=t.getComponent("SymbolHolder").s_left;for(t=this;null!=t.getComponent("SymbolHolder").s_right&&t.getComponent("SymbolHolder").s_right.getComponent("SymbolHolder").id==t.getComponent("SymbolHolder").id;)e.push(t.getComponent("SymbolHolder").s_right),t=t.getComponent("SymbolHolder").s_right;return e.length>=2},_collectRelatedSymbolList:function(){var e=[],t=[],o=this;for(e.push(o);e.length>0;)null==(o=e.pop()).getComponent("SymbolHolder").s_left||o.getComponent("SymbolHolder").s_left.getComponent("SymbolHolder").id!=o.getComponent("SymbolHolder").id||t.includes(o.getComponent("SymbolHolder").s_left)||(e.push(o.getComponent("SymbolHolder").s_left),t.push(o.getComponent("SymbolHolder").s_left)),null==o.getComponent("SymbolHolder").s_right||o.getComponent("SymbolHolder").s_right.getComponent("SymbolHolder").id!=o.getComponent("SymbolHolder").id||t.includes(o.getComponent("SymbolHolder").s_right)||(e.push(o.getComponent("SymbolHolder").s_right),t.push(o.getComponent("SymbolHolder").s_right)),null==o.getComponent("SymbolHolder").s_up||o.getComponent("SymbolHolder").s_up.getComponent("SymbolHolder").id!=o.getComponent("SymbolHolder").id||t.includes(o.getComponent("SymbolHolder").s_up)||(e.push(o.getComponent("SymbolHolder").s_up),t.push(o.getComponent("SymbolHolder").s_up)),null==o.getComponent("SymbolHolder").s_down||o.getComponent("SymbolHolder").s_down.getComponent("SymbolHolder").id!=o.getComponent("SymbolHolder").id||t.includes(o.getComponent("SymbolHolder").s_down)||(e.push(o.getComponent("SymbolHolder").s_down),t.push(o.getComponent("SymbolHolder").s_down));return t},_playExplosion:function(){null!=this.current_symbol&&(this.current_symbol.getComponent("Symbol").playExplosion(),this._onExplosion=!0)},_onFinalSymbolMovingFinished:function(){cc.log("_onFinalSymbolMovingFinished"),this._inTetris=!1},_checkSymbolManager:function(){null==this.symbol_manager&&(cc.log("manager is reset to null"),this.symbol_manager=cc.find("Canvas/symbolHolder"))},_evaluateTetris:function(){this._inTetris=!0,this._isReady=!1,this._playExplosion()},_onClick:function(e){console.log("click on holder"),console.log(this.current_symbol),this._checkSymbolManager(),this.symbol_manager.getComponent("SymbolManager")._onClickHolder(this,this.id)},_onSymbolMovingFinish:function(e){this._assignSymbol(e),this._inTetris=!1,this._onSymbolMoving=!1,this._isReady=!0},_onSymbolExplosionFinish:function(e){console.log(e),this._onExplosion=!1,this._onSymbolMoving=!0,this._checkSymbolManager(),this.symbol_manager.getComponent("SymbolManager")._onSymbolExplosionFinish(this,e)},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onClick,this)},start:function(){this.symbol_manager=cc.find("Canvas/symbolHolder"),null!=this.symbol_manager&&cc.log("managaer not null")}}),cc._RF.pop()},{}],SymbolManager:[function(e,t,o){"use strict";cc._RF.push(t,"5cb12NuU1ZFr4sPhvDEM9K7","SymbolManager");var n=e("Config"),s=e("AssetManager");cc.Class({extends:cc.Component,properties:{symbol:{default:null,type:cc.Prefab},root:{default:null,type:cc.Node},list:{default:Array(),type:[cc.Node]},symbolPool:{default:null,type:cc.NodePool},holders:{default:Array(),type:[cc.Node]},reelList:{default:[],type:[cc.Node]},s_width:{default:150,type:cc.Integer},s_height:{default:150,type:cc.Integer},s_distance_x:{default:100,type:cc.Integer},s_distance_y:{default:100,type:cc.Integer},tetris_speed:{default:150,type:cc.Integer},gameState:0},_createRandomSymbol:function(e,t){var o;return s.instance.symbolPool.size()>0?(o=s.instance.symbolPool.get()).parent=null:((o=cc.instantiate(this.symbol)).parent=null,s.instance.symbolPool.put(o)),o.getComponent("Symbol").initializeSymbol(n.instance.getRandomSymbol()),o.width=e.width,o.height=e.height,o.position=t,o},_init:function(){for(var e=0;e<this.reelList.length;e++)for(var t=this.reelList[e].getComponent("Reel").holders,o=0;o<t.length;o++){var n=this._createRandomSymbol(t[o].node,t[o].node.position);this.reelList[e].addChild(n),t[o]._assignSymbol(n)}},_addPoint:function(e,t){this.GameLogic._addPoint(e,t)},_checkGameOver:function(){for(var e=!0,t=0;t<this.reelList.length;t++){for(var o=this.reelList[t].getComponent("Reel").holders,n=0;n<o.length;n++)if(1==o[n]._isPossibleTetris()){e=!1;break}if(0==e)break}if(1==e)for(t=0;t<this.reelList.length;t++)for(o=this.reelList[t].getComponent("Reel").holders,n=0;n<o.length;n++)o[n]._evaluateTetris()},_resetSymbols:function(){for(var e=0;e<this.reelList.length;e++)for(var t=this.reelList[e].getComponent("Reel").holders,o=0;o<t.length;o++)t[o]._evaluateTetris();this.scheduleOnce(this._playingTetris,.3)},_canPlay:function(){this._checkGameOver(),cc.log("current symbol id");for(var e=0;e<this.reelList.length;e++)for(var t=this.reelList[e].getComponent("Reel").holders,o=0;o<t.length;o++)if(!t[o]._isReady)return!1;return!0},_onClickHolder:function(e,t){if(cc.log("clicked symbol "+t),1==this.GameLogic.game_state)if(this._canPlay()){for(var o=e.getComponent("SymbolHolder")._collectRelatedSymbolList(),n=!1,s=0;s<o.length;s++)if(o[s].getComponent("SymbolHolder")._isPossibleTetris()){n=!0;break}if(n&&this.GameLogic._addPoint(o.length,t),n){for(s=0;s<o.length;s++)o[s].getComponent("SymbolHolder")._evaluateTetris();this.scheduleOnce(this._playingTetris,.5)}}else cc.log("symbol is not ready")},onLoad:function(){s.instance.symbolPool=new cc.NodePool("Symbol");for(var e=0;e<=n.instance.s_count_x*n.instance.s_count_y+10;e++){var t=cc.instantiate(this.symbol);s.instance.symbolPool.put(t)}},random_symbol:function(){return Math.floor(9*Math.random())+1},_playingTetris:function(){for(var e=0;e<this.reelList.length;e++)this.reelList[e].getComponent("Reel")._playingTetris()},_onSymbolExplosionFinish:function(e,t){console.log("symbol put back to pool"),s.instance.symbolPool.put(t)},start:function(){this._init(),this.GameLogic=cc.find("Canvas/GameLogic").getComponent("GameLogic")}}),cc._RF.pop()},{AssetManager:"AssetManager",Config:"Config"}],Symbol:[function(e,t,o){"use strict";cc._RF.push(t,"86ae5c7byhOdrLTX9sD4W+N","Symbol");var n=e("Config"),s=e("AssetManager");cc.Class({extends:cc.Component,properties:{parent:{default:null,type:cc.Node},holder:{default:null,type:cc.Node},id:{default:null,type:cc.Integer}},initializeSymbol:function(e){var t=this;console.log("symbol id "+e+" initializing!!!"),this.id=e,this.holder=null;var o=this.getComponent(cc.Sprite);o.spriteFrame=null;var l=this.getComponent(cc.Animation);l.removeClip("explosion"),l.removeClip("idle");var i=s.instance._getAsset("CrystalSlots/anim/"+e+"explosion");if(null!=i){var r=i.getSpriteFrames(),a=cc.AnimationClip.createWithSpriteFrames(r,n.instance.exp_anim_speed);a.name="explosion",a.wrapMode=cc.WrapMode.Normal,l.addClip(a),this.loadedEx=!0}else cc.loader.loadRes("CrystalSlots/anim/"+e+"explosion",cc.SpriteAtlas,function(e,o){var s=o.getSpriteFrames(),i=cc.AnimationClip.createWithSpriteFrames(s,n.instance.exp_anim_speed);i.name="explosion",i.wrapMode=cc.WrapMode.Normal,l.addClip(i),t.loadedEx=!0});if(null!=(i=s.instance._getAsset("CrystalSlots/anim/"+e+"idle"))){var c=i.getSpriteFrames(),d=cc.AnimationClip.createWithSpriteFrames(c,n.instance.idle_anim_speed);d.name="idle",d.wrapMode=cc.WrapMode.Loop,l.addClip(d),this.loadedIdle=!0,o.spriteFrame=c[0]}else cc.loader.loadRes("CrystalSlots/anim/"+e+"idle",cc.SpriteAtlas,function(e,s){var i=s.getSpriteFrames();o.spriteFrame=i[0];var r=cc.AnimationClip.createWithSpriteFrames(i,n.instance.idle_anim_speed);r.name="idle",r.wrapMode=cc.WrapMode.Loop,l.addClip(r),t.loadedIdle=!0,l.play("idle")});this.schedule(this.playIdle,n.instance._random(5,15))},_setHolder:function(e){this.holder=e},_symbolMovingCenter:function(){if(0!=this.node.position.y){var e=cc.moveTo(this.node.position.y/n.instance.tetris_speed,cc.v2(0,0));this.node.runAction(cc.sequence(e,function(){this.holder._onFinalSymbolMovingFinished()}))}else this.holder._onFinalSymbolMovingFinished()},_movingSymbolFinished:function(){this._holderIterator.getComponent("SymbolHolder")._assignSymbol(this),this.holder.getComponent("SymbolHolder")._onSymbolMovingFinish(this.node),this._currentMovingTarget=null,this._holderIterator=null},_moveToHolder:function(){var e;if(this._holderIterator!=this._currentMovingTarget.node){if(this._holderIterator=this._holderIterator.getComponent("SymbolHolder").s_down,(e=Math.abs(this._holderIterator.position.y-this.node.position.y))>0){t=e/n.instance.tetris_speed,o=cc.moveTo(t,this._holderIterator.position);this.node.runAction(cc.sequence(o,cc.callFunc(this._moveToHolder,this)))}}else if(console.log("symbol in target holder"),(e=Math.abs(this._holderIterator.position.y-this.node.position.y))>0){var t=e/n.instance.tetris_speed,o=cc.moveTo(t,this._holderIterator.position);this.node.runAction(cc.sequence(o,cc.callFunc(this._movingSymbolFinished,this)))}else this._movingSymbolFinished()},_moveSymbolToHolder:function(e){this._currentMovingTarget=e,this._holderIterator=this.holder,this._moveToHolder()},playIdle:function(){this.loadedEx&&this.loadedIdle&&this.getComponent(cc.Animation).play("idle")},playExplosion:function(){if(this.deadth=!0,this.loadedEx&&this.loadedIdle){this.unschedule(this.playIdle);var e=this.getComponent(cc.Animation);e.stop(),e.play("explosion"),e.on(cc.Animation.EventType.FINISHED,this._onExplosionFinished,this)}},playLight:function(){},onLoad:function(){},_onExplosionFinished:function(){this.holder.getComponent("SymbolHolder")._onSymbolExplosionFinish(this.node)},unuse:function(){console.log(" on unuse symbol ");var e=this.getComponent(cc.Animation);null!=this.holder&&e.off(cc.Animation.EventType.FINISHED,this._onExplosionFinished,this)},reuse:function(){this.holder=null,this.id=null,this.getComponent(cc.Sprite).spriteFrame=null,console.log(" on reuse symbol ")}}),cc._RF.pop()},{AssetManager:"AssetManager",Config:"Config"}],TouchMove:[function(e,t,o){"use strict";cc._RF.push(t,"73e97QrhedDA5aWwDJtPSvH","TouchMove"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.opacity=160,this.node.on(cc.Node.EventType.TOUCH_START,function(e){var t=e.getLocation();console.log("touch moving "+t.x+" "+t.y),this.opacity=255},this.node),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.getLocation();console.log("touch moving "+t.x+" "+t.y),this.opacity=255;var o=e.touch.getDelta();this.x+=o.x,this.y+=o.y},this.node),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.opacity=160},this.node)}}),cc._RF.pop()},{}]},{},["AnimationManager","AssetManager","Color","Config","GameLogic","LoadAssetManager","NextLevelRequierment","Reel","Symbol","SymbolHolder","SymbolManager","TouchMove"]);